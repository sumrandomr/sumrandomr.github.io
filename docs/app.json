[{"name":"app.R","content":"library(shiny)\r\nlibrary(readr)\r\nlibrary(dplyr)\r\n\r\n# Define UI\r\nui <- fluidPage(\r\n  titlePanel(\"ISCO Code Generator\"),\r\n  sidebarLayout(\r\n    sidebarPanel(\r\n      fileInput(\"file1\", \"Choose CSV File\", accept = \".csv\"),\r\n      uiOutput(\"column_ui1\"),\r\n      uiOutput(\"column_ui2\"),\r\n      actionButton(\"process\", \"Generate ISCO Codes\")\r\n    ),\r\n    mainPanel(\r\n      tableOutput(\"contents\"),\r\n      downloadButton(\"downloadData\", \"Download\")\r\n    )\r\n  )\r\n)\r\n\r\n# Define server logic\r\nserver <- function(input, output, session) {\r\n  data <- reactive({\r\n    req(input$file1)\r\n    read_csv(input$file1$datapath)\r\n  })\r\n  \r\n  output$column_ui1 <- renderUI({\r\n    req(data())\r\n    selectInput(\"column1\", \"Select 'Occupation Parent 1' Column\", choices = names(data()))\r\n  })\r\n  \r\n  output$column_ui2 <- renderUI({\r\n    req(data())\r\n    selectInput(\"column2\", \"Select 'Occupation Parent 2' Column\", choices = names(data()))\r\n  })\r\n  \r\n  observeEvent(input$process, {\r\n    req(input$column1, input$column2)\r\n    \r\n    df <- data()\r\n    df <- df %>%\r\n      mutate(\r\n        Occupation_Parent_1_ISCO = sapply(df[[input$column1]], generateISCO),\r\n        Occupation_Parent_2_ISCO = sapply(df[[input$column2]], generateISCO)\r\n      )\r\n    \r\n    output$contents <- renderTable({\r\n      df\r\n    })\r\n    \r\n    output$downloadData <- downloadHandler(\r\n      filename = function() {\r\n        paste(\"output-\", Sys.Date(), \".csv\", sep = \"\")\r\n      },\r\n      content = function(file) {\r\n        write_csv(df, file)\r\n      }\r\n    )\r\n  })\r\n}\r\n\r\n# Placeholder function for generating ISCO codes\r\ngenerateISCO <- function(occupation) {\r\n  # This is where you would use the Copilot API to generate ISCO codes\r\n  # For now, we'll just return a dummy ISCO code\r\n  return(\"1234\")\r\n}\r\n\r\n# Run the application \r\nshinyApp(ui = ui, server = server)","type":"text"}]
